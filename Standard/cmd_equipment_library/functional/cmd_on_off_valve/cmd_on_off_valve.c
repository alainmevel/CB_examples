/*2023-10-03T11:13:37-01:00*/

/********************************************************************
 * cmd_on_off_valve.c
 * 
 * generated by: plcgen 3.1.391
 ********************************************************************/

#include "cb_comp.h"
#include "iec_1131.h"


/********************************************************************
 *                  Inner 'actuator' declarations                   *
 ********************************************************************/


/********************** Variable declarations ***********************/

static CB_Index actuator__num;
extern CB_Mem_Bool *_i_cmd_on_off_valve__actuator_autoMode;
extern CB_Mem_Bool *_i_cmd_on_off_valve__actuator_manualMode;
extern CB_Mem_Bool *_i_cmd_on_off_valve__actuator_autoCloseCmd;
extern CB_Mem_Bool *_i_cmd_on_off_valve__actuator_autoOpenCmd;
extern CB_Mem_Bool *_i_cmd_on_off_valve__actuator_closedSensorFB;
extern CB_Mem_Bool *_i_cmd_on_off_valve__actuator_openedSensorFB;
extern CB_Mem_Bool *_i_cmd_on_off_valve__actuator_closeValvePB;
extern CB_Mem_Bool *_i_cmd_on_off_valve__actuator_openValvePB;
extern CB_Mem_Bool *_i_cmd_on_off_valve__actuator_generalFault;
extern CB_Mem_Bool *_i_cmd_on_off_valve__actuator_closeCmd;
extern CB_Mem_Bool *_i_cmd_on_off_valve__actuator_openCmd;

/********************** Function declarations ***********************/

static int _cmd_equipment_library__actuator_init(void);
static int cmd_equipment_library__actuator(void);

/********************************************************************
 *                   Inner 'faults' declarations                    *
 ********************************************************************/


/********************** Variable declarations ***********************/

static CB_Index faults__num;
extern CB_Mem_Bool *_i_cmd_on_off_valve__faults_closeCmd;
extern CB_Mem_Bool *_i_cmd_on_off_valve__faults_openCmd;
extern CB_Mem_Bool *_i_cmd_on_off_valve__faults_closedSensorFB;
extern CB_Mem_Bool *_i_cmd_on_off_valve__faults_openedSensorFB;
extern CB_Mem_Bool *_i_cmd_on_off_valve__faults_acknowledgePB;
extern CB_Mem_Bool *_i_cmd_on_off_valve__faults_generalFault;
extern CB_Mem_Bool *_i_cmd_on_off_valve__faults_closedSensorFault;
extern CB_Mem_Bool *_i_cmd_on_off_valve__faults_openedSensorFault;
extern CB_Mem_Bool *_i_cmd_on_off_valve__faults_discordanceFault;
extern CB_Mem_Int *_i_cmd_on_off_valve__faults_ton_sec_1_i_ton;
extern CB_Mem_Float *_i_cmd_on_off_valve__faults_ton_sec_1_t1_ton;
extern CB_Mem_Int *_i_cmd_on_off_valve__faults_ton_sec_1_t2_ton;
extern CB_Mem_Bool *_i_cmd_on_off_valve__faults_ton_sec_1_Q;
extern CB_Mem_Int *_i_cmd_on_off_valve__faults_ton_sec_1_CV;
extern CB_Mem_Int *_i_cmd_on_off_valve__faults_ton_sec_2_i_ton;
extern CB_Mem_Float *_i_cmd_on_off_valve__faults_ton_sec_2_t1_ton;
extern CB_Mem_Int *_i_cmd_on_off_valve__faults_ton_sec_2_t2_ton;
extern CB_Mem_Bool *_i_cmd_on_off_valve__faults_ton_sec_2_Q;
extern CB_Mem_Int *_i_cmd_on_off_valve__faults_ton_sec_2_CV;
extern CB_Mem_Int *_i_cmd_on_off_valve__faults_ton_ms_3_i_tonms;
extern CB_Mem_Float *_i_cmd_on_off_valve__faults_ton_ms_3_t1_tonms;
extern CB_Mem_Int *_i_cmd_on_off_valve__faults_ton_ms_3_t2_tonms;
extern CB_Mem_Bool *_i_cmd_on_off_valve__faults_ton_ms_3_Q;
extern CB_Mem_Int *_i_cmd_on_off_valve__faults_ton_ms_3_CV;
extern CB_Mem_Int *_i_cmd_on_off_valve__faults_presetMvt;
extern CB_Mem_Int *_i_cmd_on_off_valve__faults_presetDiscordance;

/********************** Function declarations ***********************/

static int _cmd_equipment_library__faults_init(void);
static int cmd_equipment_library__faults(void);

/********************************************************************
 *                 Inner 'actuator' implementation                  *
 ********************************************************************/



/**************************** Variables *****************************/

static CB_Index actuator__num = 0;
CB_Mem_Bool *_i_cmd_on_off_valve__actuator_autoMode;
CB_Mem_Bool *_i_cmd_on_off_valve__actuator_manualMode;
CB_Mem_Bool *_i_cmd_on_off_valve__actuator_autoCloseCmd;
CB_Mem_Bool *_i_cmd_on_off_valve__actuator_autoOpenCmd;
CB_Mem_Bool *_i_cmd_on_off_valve__actuator_closedSensorFB;
CB_Mem_Bool *_i_cmd_on_off_valve__actuator_openedSensorFB;
CB_Mem_Bool *_i_cmd_on_off_valve__actuator_closeValvePB;
CB_Mem_Bool *_i_cmd_on_off_valve__actuator_openValvePB;
CB_Mem_Bool *_i_cmd_on_off_valve__actuator_generalFault;
CB_Mem_Bool *_i_cmd_on_off_valve__actuator_closeCmd;
CB_Mem_Bool *_i_cmd_on_off_valve__actuator_openCmd;

/**************************** Variables *****************************/

#define autoMode (_i_cmd_on_off_valve__actuator_autoMode->CB_current_value)
#define manualMode (_i_cmd_on_off_valve__actuator_manualMode->CB_current_value)
#define autoCloseCmd (_i_cmd_on_off_valve__actuator_autoCloseCmd->CB_current_value)
#define autoOpenCmd (_i_cmd_on_off_valve__actuator_autoOpenCmd->CB_current_value)
#define closedSensorFB (_i_cmd_on_off_valve__actuator_closedSensorFB->CB_current_value)
#define openedSensorFB (_i_cmd_on_off_valve__actuator_openedSensorFB->CB_current_value)
#define closeValvePB (_i_cmd_on_off_valve__actuator_closeValvePB->CB_current_value)
#define openValvePB (_i_cmd_on_off_valve__actuator_openValvePB->CB_current_value)
#define generalFault (_i_cmd_on_off_valve__actuator_generalFault->CB_current_value)
#define closeCmd (_i_cmd_on_off_valve__actuator_closeCmd->CB_current_value)
#define openCmd (_i_cmd_on_off_valve__actuator_openCmd->CB_current_value)


/************************ Components offsets ************************/


/********************* Initialization function **********************/

static int _cmd_equipment_library__actuator_init(void)
{


	return 0;
}


/************************ Behavior function *************************/

static int cmd_equipment_library__actuator(void)
{
	if (exec_term_node(self_num)) {

		/*********************** Internals variables ************************/


		/********************* Pre-conditions execution *********************/

		/*no Pre-conditions*/

		/************************ Behavior execution ************************/

		{
			openCmd = ((((autoMode && autoOpenCmd) && !autoCloseCmd) || ((manualMode && openValvePB) && !closeValvePB)) && !openedSensorFB) && !generalFault;
			closeCmd = ((((autoMode && autoCloseCmd) && !autoOpenCmd) || ((manualMode && closeValvePB) && !openValvePB)) && !closedSensorFB) && !generalFault;
		}

		CB_post_bool(_i_cmd_on_off_valve__actuator_closeCmd);
		CB_post_bool(_i_cmd_on_off_valve__actuator_openCmd);

		/******************** Post-conditions execution *********************/

		/*no Post-conditions*/
	}

	/*************************** self update ****************************/


	return 0;
}

#undef autoMode
#undef manualMode
#undef autoCloseCmd
#undef autoOpenCmd
#undef closedSensorFB
#undef openedSensorFB
#undef closeValvePB
#undef openValvePB
#undef generalFault
#undef closeCmd
#undef openCmd

/********************************************************************
 *                  Inner 'faults' implementation                   *
 ********************************************************************/

#include "timers_counters/functional/cb_ton/cb_ton.h"


/**************************** Variables *****************************/

static CB_Index faults__num = 0;
CB_Mem_Bool *_i_cmd_on_off_valve__faults_closeCmd;
CB_Mem_Bool *_i_cmd_on_off_valve__faults_openCmd;
CB_Mem_Bool *_i_cmd_on_off_valve__faults_closedSensorFB;
CB_Mem_Bool *_i_cmd_on_off_valve__faults_openedSensorFB;
CB_Mem_Bool *_i_cmd_on_off_valve__faults_acknowledgePB;
CB_Mem_Bool *_i_cmd_on_off_valve__faults_generalFault;
CB_Mem_Bool *_i_cmd_on_off_valve__faults_closedSensorFault;
CB_Mem_Bool *_i_cmd_on_off_valve__faults_openedSensorFault;
CB_Mem_Bool *_i_cmd_on_off_valve__faults_discordanceFault;
CB_Mem_Int *_i_cmd_on_off_valve__faults_ton_sec_1_i_ton;
CB_Mem_Float *_i_cmd_on_off_valve__faults_ton_sec_1_t1_ton;
CB_Mem_Int *_i_cmd_on_off_valve__faults_ton_sec_1_t2_ton;
CB_Mem_Bool *_i_cmd_on_off_valve__faults_ton_sec_1_Q;
CB_Mem_Int *_i_cmd_on_off_valve__faults_ton_sec_1_CV;
CB_Mem_Int *_i_cmd_on_off_valve__faults_ton_sec_2_i_ton;
CB_Mem_Float *_i_cmd_on_off_valve__faults_ton_sec_2_t1_ton;
CB_Mem_Int *_i_cmd_on_off_valve__faults_ton_sec_2_t2_ton;
CB_Mem_Bool *_i_cmd_on_off_valve__faults_ton_sec_2_Q;
CB_Mem_Int *_i_cmd_on_off_valve__faults_ton_sec_2_CV;
CB_Mem_Int *_i_cmd_on_off_valve__faults_ton_ms_3_i_tonms;
CB_Mem_Float *_i_cmd_on_off_valve__faults_ton_ms_3_t1_tonms;
CB_Mem_Int *_i_cmd_on_off_valve__faults_ton_ms_3_t2_tonms;
CB_Mem_Bool *_i_cmd_on_off_valve__faults_ton_ms_3_Q;
CB_Mem_Int *_i_cmd_on_off_valve__faults_ton_ms_3_CV;
CB_Mem_Int *_i_cmd_on_off_valve__faults_presetMvt;
CB_Mem_Int *_i_cmd_on_off_valve__faults_presetDiscordance;
CB_Mem_Bool *_i_cmd_on_off_valve__faults_TON_O_IN;
CB_Mem_Int *_i_cmd_on_off_valve__faults_TON_O_PT;
CB_Mem_Bool *_i_cmd_on_off_valve__faults_TON_O_Q0;
CB_Mem_Int *_i_cmd_on_off_valve__faults_TON_O_CV;
CB_Mem_Bool *_i_cmd_on_off_valve__faults_TON_C_IN;
CB_Mem_Int *_i_cmd_on_off_valve__faults_TON_C_PT;
CB_Mem_Bool *_i_cmd_on_off_valve__faults_TON_C_Q0;
CB_Mem_Int *_i_cmd_on_off_valve__faults_TON_C_CV;
CB_Mem_Bool *_i_cmd_on_off_valve__faults_TON_DISC_IN;
CB_Mem_Int *_i_cmd_on_off_valve__faults_TON_DISC_PT;
CB_Mem_Bool *_i_cmd_on_off_valve__faults_TON_DISC_Q0;
CB_Mem_Int *_i_cmd_on_off_valve__faults_TON_DISC_CV;

/**************************** Variables *****************************/

#define closeCmd (_i_cmd_on_off_valve__faults_closeCmd->CB_current_value)
#define openCmd (_i_cmd_on_off_valve__faults_openCmd->CB_current_value)
#define closedSensorFB (_i_cmd_on_off_valve__faults_closedSensorFB->CB_current_value)
#define openedSensorFB (_i_cmd_on_off_valve__faults_openedSensorFB->CB_current_value)
#define acknowledgePB (_i_cmd_on_off_valve__faults_acknowledgePB->CB_current_value)
#define generalFault (_i_cmd_on_off_valve__faults_generalFault->CB_current_value)
#define closedSensorFault (_i_cmd_on_off_valve__faults_closedSensorFault->CB_current_value)
#define openedSensorFault (_i_cmd_on_off_valve__faults_openedSensorFault->CB_current_value)
#define discordanceFault (_i_cmd_on_off_valve__faults_discordanceFault->CB_current_value)
#define ton_sec_1_i_ton (_i_cmd_on_off_valve__faults_ton_sec_1_i_ton->CB_current_value)
#define ton_sec_1_t1_ton (_i_cmd_on_off_valve__faults_ton_sec_1_t1_ton->CB_current_value)
#define ton_sec_1_t2_ton (_i_cmd_on_off_valve__faults_ton_sec_1_t2_ton->CB_current_value)
#define ton_sec_1_Q (_i_cmd_on_off_valve__faults_ton_sec_1_Q->CB_current_value)
#define ton_sec_1_CV (_i_cmd_on_off_valve__faults_ton_sec_1_CV->CB_current_value)
#define ton_sec_2_i_ton (_i_cmd_on_off_valve__faults_ton_sec_2_i_ton->CB_current_value)
#define ton_sec_2_t1_ton (_i_cmd_on_off_valve__faults_ton_sec_2_t1_ton->CB_current_value)
#define ton_sec_2_t2_ton (_i_cmd_on_off_valve__faults_ton_sec_2_t2_ton->CB_current_value)
#define ton_sec_2_Q (_i_cmd_on_off_valve__faults_ton_sec_2_Q->CB_current_value)
#define ton_sec_2_CV (_i_cmd_on_off_valve__faults_ton_sec_2_CV->CB_current_value)
#define ton_ms_3_i_tonms (_i_cmd_on_off_valve__faults_ton_ms_3_i_tonms->CB_current_value)
#define ton_ms_3_t1_tonms (_i_cmd_on_off_valve__faults_ton_ms_3_t1_tonms->CB_current_value)
#define ton_ms_3_t2_tonms (_i_cmd_on_off_valve__faults_ton_ms_3_t2_tonms->CB_current_value)
#define ton_ms_3_Q (_i_cmd_on_off_valve__faults_ton_ms_3_Q->CB_current_value)
#define ton_ms_3_CV (_i_cmd_on_off_valve__faults_ton_ms_3_CV->CB_current_value)
#define presetMvt(i) (_i_cmd_on_off_valve__faults_presetMvt[i+1].CB_current_value)
#define presetDiscordance(i) (_i_cmd_on_off_valve__faults_presetDiscordance[i+1].CB_current_value)
#define TON_O_IN (_i_cmd_on_off_valve__faults_TON_O_IN->CB_current_value)
#define TON_O_PT(i) (_i_cmd_on_off_valve__faults_TON_O_PT[i+1].CB_current_value)
#define TON_O_Q0 (_i_cmd_on_off_valve__faults_TON_O_Q0->CB_current_value)
#define TON_O_CV(i) (_i_cmd_on_off_valve__faults_TON_O_CV[i+1].CB_current_value)
#define TON_C_IN (_i_cmd_on_off_valve__faults_TON_C_IN->CB_current_value)
#define TON_C_PT(i) (_i_cmd_on_off_valve__faults_TON_C_PT[i+1].CB_current_value)
#define TON_C_Q0 (_i_cmd_on_off_valve__faults_TON_C_Q0->CB_current_value)
#define TON_C_CV(i) (_i_cmd_on_off_valve__faults_TON_C_CV[i+1].CB_current_value)
#define TON_DISC_IN (_i_cmd_on_off_valve__faults_TON_DISC_IN->CB_current_value)
#define TON_DISC_PT(i) (_i_cmd_on_off_valve__faults_TON_DISC_PT[i+1].CB_current_value)
#define TON_DISC_Q0 (_i_cmd_on_off_valve__faults_TON_DISC_Q0->CB_current_value)
#define TON_DISC_CV(i) (_i_cmd_on_off_valve__faults_TON_DISC_CV[i+1].CB_current_value)


/************************ Components offsets ************************/

static CB_Index cmd_equipment_library__faults_dnum_TON_O;
static CB_Index cmd_equipment_library__faults_dnum_TON_C;
static CB_Index cmd_equipment_library__faults_dnum_TON_DISC;
static CB_Index cmd_equipment_library__faults_dnum__end;

static CB_Offset cmd_equipment_library__faults_offset_TON_O;
static CB_Offset cmd_equipment_library__faults_offset_TON_C;
static CB_Offset cmd_equipment_library__faults_offset_TON_DISC;
static CB_Offset cmd_equipment_library__faults_offset__end = {0, 0, 0, 0};


/********************* Initialization function **********************/

static int _cmd_equipment_library__faults_init(void)
{
	CB_Index __my_num = self_num;
	CB_Object __start = self;
	(self.Int+9+3)->CB_current_value = 40000; /*presetMvt[2]*/
	(self.Int+13+3)->CB_current_value = 2000; /*presetDiscordance[2]*/
	self.Bool+=12;
	self.Int+=41;
	self.Float+=3;

	/*initialize child TON_O (timers_counters.cb_ton):*/
	self_num++;
	cmd_equipment_library__faults_dnum_TON_O = self_num - __my_num;
	cmd_equipment_library__faults_offset_TON_O.Bool = self.Bool - __start.Bool;
	cmd_equipment_library__faults_offset_TON_O.Int = self.Int - __start.Int;
	cmd_equipment_library__faults_offset_TON_O.Float = self.Float - __start.Float;
	cmd_equipment_library__faults_offset_TON_O.Char = self.Char - __start.Char;
	cb_ton_IN = __start.Bool+6; /*TON_O_IN*/
	cb_ton_PT = __start.Int+17; /*TON_O_PT*/
	cb_ton_Q0 = __start.Bool+7; /*TON_O_Q0*/
	cb_ton_CV = __start.Int+21; /*TON_O_CV*/
	_timers_counters__cb_ton_init();

	/*initialize child TON_C (timers_counters.cb_ton):*/
	self_num++;
	cmd_equipment_library__faults_dnum_TON_C = self_num - __my_num;
	cmd_equipment_library__faults_offset_TON_C.Bool = self.Bool - __start.Bool;
	cmd_equipment_library__faults_offset_TON_C.Int = self.Int - __start.Int;
	cmd_equipment_library__faults_offset_TON_C.Float = self.Float - __start.Float;
	cmd_equipment_library__faults_offset_TON_C.Char = self.Char - __start.Char;
	cb_ton_IN = __start.Bool+8; /*TON_C_IN*/
	cb_ton_PT = __start.Int+25; /*TON_C_PT*/
	cb_ton_Q0 = __start.Bool+9; /*TON_C_Q0*/
	cb_ton_CV = __start.Int+29; /*TON_C_CV*/
	_timers_counters__cb_ton_init();

	/*initialize child TON_DISC (timers_counters.cb_ton):*/
	self_num++;
	cmd_equipment_library__faults_dnum_TON_DISC = self_num - __my_num;
	cmd_equipment_library__faults_offset_TON_DISC.Bool = self.Bool - __start.Bool;
	cmd_equipment_library__faults_offset_TON_DISC.Int = self.Int - __start.Int;
	cmd_equipment_library__faults_offset_TON_DISC.Float = self.Float - __start.Float;
	cmd_equipment_library__faults_offset_TON_DISC.Char = self.Char - __start.Char;
	cb_ton_IN = __start.Bool+10; /*TON_DISC_IN*/
	cb_ton_PT = __start.Int+33; /*TON_DISC_PT*/
	cb_ton_Q0 = __start.Bool+11; /*TON_DISC_Q0*/
	cb_ton_CV = __start.Int+37; /*TON_DISC_CV*/
	_timers_counters__cb_ton_init();

	cmd_equipment_library__faults_dnum__end = self_num - __my_num;
	cmd_equipment_library__faults_offset__end.Bool = self.Bool - __start.Bool;
	cmd_equipment_library__faults_offset__end.Int = self.Int - __start.Int;
	cmd_equipment_library__faults_offset__end.Float = self.Float - __start.Float;
	cmd_equipment_library__faults_offset__end.Char = self.Char - __start.Char;

	return 0;
}


/************************ Behavior function *************************/

static int cmd_equipment_library__faults(void)
{
	CB_Object __start = self;
	CB_Index __my_num = self_num;
	int __ret;
	if (exec_term_node(self_num)) {

		/*********************** Internals variables ************************/

		_i_cmd_on_off_valve__faults_closedSensorFault = self.Bool+0;
		_i_cmd_on_off_valve__faults_openedSensorFault = self.Bool+1;
		_i_cmd_on_off_valve__faults_discordanceFault = self.Bool+2;
		_i_cmd_on_off_valve__faults_ton_sec_1_i_ton = self.Int+0;
		_i_cmd_on_off_valve__faults_ton_sec_1_t1_ton = self.Float+0;
		_i_cmd_on_off_valve__faults_ton_sec_1_t2_ton = self.Int+1;
		_i_cmd_on_off_valve__faults_ton_sec_1_Q = self.Bool+3;
		_i_cmd_on_off_valve__faults_ton_sec_1_CV = self.Int+2;
		_i_cmd_on_off_valve__faults_ton_sec_2_i_ton = self.Int+3;
		_i_cmd_on_off_valve__faults_ton_sec_2_t1_ton = self.Float+1;
		_i_cmd_on_off_valve__faults_ton_sec_2_t2_ton = self.Int+4;
		_i_cmd_on_off_valve__faults_ton_sec_2_Q = self.Bool+4;
		_i_cmd_on_off_valve__faults_ton_sec_2_CV = self.Int+5;
		_i_cmd_on_off_valve__faults_ton_ms_3_i_tonms = self.Int+6;
		_i_cmd_on_off_valve__faults_ton_ms_3_t1_tonms = self.Float+2;
		_i_cmd_on_off_valve__faults_ton_ms_3_t2_tonms = self.Int+7;
		_i_cmd_on_off_valve__faults_ton_ms_3_Q = self.Bool+5;
		_i_cmd_on_off_valve__faults_ton_ms_3_CV = self.Int+8;
		_i_cmd_on_off_valve__faults_presetMvt = self.Int+9;
		_i_cmd_on_off_valve__faults_presetDiscordance = self.Int+13;
		_i_cmd_on_off_valve__faults_TON_O_IN = self.Bool+6;
		_i_cmd_on_off_valve__faults_TON_O_PT = self.Int+17;
		_i_cmd_on_off_valve__faults_TON_O_Q0 = self.Bool+7;
		_i_cmd_on_off_valve__faults_TON_O_CV = self.Int+21;
		_i_cmd_on_off_valve__faults_TON_C_IN = self.Bool+8;
		_i_cmd_on_off_valve__faults_TON_C_PT = self.Int+25;
		_i_cmd_on_off_valve__faults_TON_C_Q0 = self.Bool+9;
		_i_cmd_on_off_valve__faults_TON_C_CV = self.Int+29;
		_i_cmd_on_off_valve__faults_TON_DISC_IN = self.Bool+10;
		_i_cmd_on_off_valve__faults_TON_DISC_PT = self.Int+33;
		_i_cmd_on_off_valve__faults_TON_DISC_Q0 = self.Bool+11;
		_i_cmd_on_off_valve__faults_TON_DISC_CV = self.Int+37;

		/********************* Pre-conditions execution *********************/

		/*no Pre-conditions*/

		/************************ Behavior execution ************************/

		{
			unsigned char _1;
			unsigned char _13_Q0;
			CB_Mem_Int _13_CV[4] =  { cb_int_header(2) };
			unsigned char _14_Q0;
			CB_Mem_Int _14_CV[4] =  { cb_int_header(2) };
			unsigned char _19_Q0;
			CB_Mem_Int _19_CV[4] =  { cb_int_header(2) };
			_1 = acknowledgePB;
			if (_1) {
				closedSensorFault = 0;
			}
			if (_1) {
				openedSensorFault = 0;
			}
			if (_1) {
				discordanceFault = 0;
			}
			if (_1) {
				generalFault = 0;
			}
			/*call user FB TON_O():*/
			TON_O_IN = openCmd;
			copy_int_array(_i_cmd_on_off_valve__faults_TON_O_PT, _i_cmd_on_off_valve__faults_presetMvt, 2);
			self.Bool = __start.Bool + cmd_equipment_library__faults_offset_TON_O.Bool;
			self.Int = __start.Int + cmd_equipment_library__faults_offset_TON_O.Int;
			self.Float = __start.Float + cmd_equipment_library__faults_offset_TON_O.Float;
			self.Char = __start.Char + cmd_equipment_library__faults_offset_TON_O.Char;
			self_num = __my_num + cmd_equipment_library__faults_dnum_TON_O;
			if (cb_ton__num != self_num) {
				cb_ton__num = self_num;
				cb_ton_IN = _i_cmd_on_off_valve__faults_TON_O_IN;
				cb_ton_PT = _i_cmd_on_off_valve__faults_TON_O_PT;
				cb_ton_Q0 = _i_cmd_on_off_valve__faults_TON_O_Q0;
				cb_ton_CV = _i_cmd_on_off_valve__faults_TON_O_CV;
			}
			__ret = timers_counters__cb_ton();
			if (__ret != 0) {
				return __ret; /*user FB failure*/
			}
			self_num = __my_num;
			_13_Q0 = TON_O_Q0;
			copy_int_array(_13_CV, _i_cmd_on_off_valve__faults_TON_O_CV, 2);
			/*end TON_O()*/
			if (_13_Q0 && !openedSensorFB) {
				openedSensorFault = 1;
			}
			/*call user FB TON_C():*/
			TON_C_IN = closeCmd;
			copy_int_array(_i_cmd_on_off_valve__faults_TON_C_PT, _i_cmd_on_off_valve__faults_presetMvt, 2);
			self.Bool = __start.Bool + cmd_equipment_library__faults_offset_TON_C.Bool;
			self.Int = __start.Int + cmd_equipment_library__faults_offset_TON_C.Int;
			self.Float = __start.Float + cmd_equipment_library__faults_offset_TON_C.Float;
			self.Char = __start.Char + cmd_equipment_library__faults_offset_TON_C.Char;
			self_num = __my_num + cmd_equipment_library__faults_dnum_TON_C;
			if (cb_ton__num != self_num) {
				cb_ton__num = self_num;
				cb_ton_IN = _i_cmd_on_off_valve__faults_TON_C_IN;
				cb_ton_PT = _i_cmd_on_off_valve__faults_TON_C_PT;
				cb_ton_Q0 = _i_cmd_on_off_valve__faults_TON_C_Q0;
				cb_ton_CV = _i_cmd_on_off_valve__faults_TON_C_CV;
			}
			__ret = timers_counters__cb_ton();
			if (__ret != 0) {
				return __ret; /*user FB failure*/
			}
			self_num = __my_num;
			_14_Q0 = TON_C_Q0;
			copy_int_array(_14_CV, _i_cmd_on_off_valve__faults_TON_C_CV, 2);
			/*end TON_C()*/
			if (_14_Q0 && !closedSensorFB) {
				closedSensorFault = 1;
			}
			/*call user FB TON_DISC():*/
			TON_DISC_IN = openedSensorFB && closedSensorFB;
			copy_int_array(_i_cmd_on_off_valve__faults_TON_DISC_PT, _i_cmd_on_off_valve__faults_presetDiscordance, 2);
			self.Bool = __start.Bool + cmd_equipment_library__faults_offset_TON_DISC.Bool;
			self.Int = __start.Int + cmd_equipment_library__faults_offset_TON_DISC.Int;
			self.Float = __start.Float + cmd_equipment_library__faults_offset_TON_DISC.Float;
			self.Char = __start.Char + cmd_equipment_library__faults_offset_TON_DISC.Char;
			self_num = __my_num + cmd_equipment_library__faults_dnum_TON_DISC;
			if (cb_ton__num != self_num) {
				cb_ton__num = self_num;
				cb_ton_IN = _i_cmd_on_off_valve__faults_TON_DISC_IN;
				cb_ton_PT = _i_cmd_on_off_valve__faults_TON_DISC_PT;
				cb_ton_Q0 = _i_cmd_on_off_valve__faults_TON_DISC_Q0;
				cb_ton_CV = _i_cmd_on_off_valve__faults_TON_DISC_CV;
			}
			__ret = timers_counters__cb_ton();
			if (__ret != 0) {
				return __ret; /*user FB failure*/
			}
			self_num = __my_num;
			_19_Q0 = TON_DISC_Q0;
			copy_int_array(_19_CV, _i_cmd_on_off_valve__faults_TON_DISC_CV, 2);
			/*end TON_DISC()*/
			if (_19_Q0) {
				discordanceFault = 1;
			}
			if ((closedSensorFault || openedSensorFault) || discordanceFault) {
				generalFault = 1;
			}
		}

		if(nb_alloc > 0) {
			free_all_alloc();
		}

		CB_post_bool(_i_cmd_on_off_valve__faults_generalFault);

		/******************** Post-conditions execution *********************/

		/*no Post-conditions*/
	}

	/*************************** self update ****************************/

	self_num = __my_num + cmd_equipment_library__faults_dnum__end;
	self.Bool = __start.Bool + cmd_equipment_library__faults_offset__end.Bool;
	self.Int = __start.Int + cmd_equipment_library__faults_offset__end.Int;
	self.Float = __start.Float + cmd_equipment_library__faults_offset__end.Float;
	self.Char = __start.Char + cmd_equipment_library__faults_offset__end.Char;

	return 0;
}

#undef closeCmd
#undef openCmd
#undef closedSensorFB
#undef openedSensorFB
#undef acknowledgePB
#undef generalFault
#undef closedSensorFault
#undef openedSensorFault
#undef discordanceFault
#undef ton_sec_1_i_ton
#undef ton_sec_1_t1_ton
#undef ton_sec_1_t2_ton
#undef ton_sec_1_Q
#undef ton_sec_1_CV
#undef ton_sec_2_i_ton
#undef ton_sec_2_t1_ton
#undef ton_sec_2_t2_ton
#undef ton_sec_2_Q
#undef ton_sec_2_CV
#undef ton_ms_3_i_tonms
#undef ton_ms_3_t1_tonms
#undef ton_ms_3_t2_tonms
#undef ton_ms_3_Q
#undef ton_ms_3_CV
#undef presetMvt
#undef presetDiscordance
#undef TON_O_IN
#undef TON_O_PT
#undef TON_O_Q0
#undef TON_O_CV
#undef TON_C_IN
#undef TON_C_PT
#undef TON_C_Q0
#undef TON_C_CV
#undef TON_DISC_IN
#undef TON_DISC_PT
#undef TON_DISC_Q0
#undef TON_DISC_CV

/********************************************************************
 *  Public 'cmd_equipment_library.cmd_on_off_valve' implementation  *
 ********************************************************************/

#include "cmd_on_off_valve.h"


/**************************** Variables *****************************/

CB_Index cmd_on_off_valve__num = 0;
CB_Mem_Bool *cmd_on_off_valve_autoMode;
CB_Mem_Bool *cmd_on_off_valve_manualMode;
CB_Mem_Bool *cmd_on_off_valve_closedSensorFB;
CB_Mem_Bool *cmd_on_off_valve_openedSensorFB;
CB_Mem_Bool *cmd_on_off_valve_autoCloseCmd;
CB_Mem_Bool *cmd_on_off_valve_autoOpenCmd;
CB_Mem_Bool *cmd_on_off_valve_closeValvePB;
CB_Mem_Bool *cmd_on_off_valve_openValvePB;
CB_Mem_Bool *cmd_on_off_valve_acknowledgePB;
CB_Mem_Bool *cmd_on_off_valve_closeCmd;
CB_Mem_Bool *cmd_on_off_valve_openCmd;
CB_Mem_Bool *cmd_on_off_valve_generalFault;

/**************************** Variables *****************************/



/************************ Components offsets ************************/

static CB_Offset cmd_equipment_library__cmd_on_off_valve_offset_actions;
static CB_Offset cmd_equipment_library__cmd_on_off_valve_offset_faults1;
static CB_Offset cmd_equipment_library__cmd_on_off_valve_offset__end = {0, 0, 0, 0};


/********************* Initialization function **********************/

int _cmd_equipment_library__cmd_on_off_valve_init(void)
{
	CB_Object __start = self;

	/*initialize child actions (cmd_equipment_library.actuator):*/
	self_num++;
	cmd_equipment_library__cmd_on_off_valve_offset_actions.Bool = self.Bool - __start.Bool;
	cmd_equipment_library__cmd_on_off_valve_offset_actions.Int = self.Int - __start.Int;
	cmd_equipment_library__cmd_on_off_valve_offset_actions.Float = self.Float - __start.Float;
	cmd_equipment_library__cmd_on_off_valve_offset_actions.Char = self.Char - __start.Char;
	_i_cmd_on_off_valve__actuator_autoMode = cmd_on_off_valve_autoMode;
	_i_cmd_on_off_valve__actuator_manualMode = cmd_on_off_valve_manualMode;
	_i_cmd_on_off_valve__actuator_autoCloseCmd = cmd_on_off_valve_autoCloseCmd;
	_i_cmd_on_off_valve__actuator_autoOpenCmd = cmd_on_off_valve_autoOpenCmd;
	_i_cmd_on_off_valve__actuator_closedSensorFB = cmd_on_off_valve_closedSensorFB;
	_i_cmd_on_off_valve__actuator_openedSensorFB = cmd_on_off_valve_openedSensorFB;
	_i_cmd_on_off_valve__actuator_closeValvePB = cmd_on_off_valve_closeValvePB;
	_i_cmd_on_off_valve__actuator_openValvePB = cmd_on_off_valve_openValvePB;
	_i_cmd_on_off_valve__actuator_generalFault = cmd_on_off_valve_generalFault;
	_i_cmd_on_off_valve__actuator_closeCmd = cmd_on_off_valve_closeCmd;
	_i_cmd_on_off_valve__actuator_openCmd = cmd_on_off_valve_openCmd;
	_cmd_equipment_library__actuator_init();

	/*initialize child faults1 (cmd_equipment_library.faults):*/
	self_num++;
	cmd_equipment_library__cmd_on_off_valve_offset_faults1.Bool = self.Bool - __start.Bool;
	cmd_equipment_library__cmd_on_off_valve_offset_faults1.Int = self.Int - __start.Int;
	cmd_equipment_library__cmd_on_off_valve_offset_faults1.Float = self.Float - __start.Float;
	cmd_equipment_library__cmd_on_off_valve_offset_faults1.Char = self.Char - __start.Char;
	_i_cmd_on_off_valve__faults_closeCmd = cmd_on_off_valve_closeCmd;
	_i_cmd_on_off_valve__faults_openCmd = cmd_on_off_valve_openCmd;
	_i_cmd_on_off_valve__faults_closedSensorFB = cmd_on_off_valve_closedSensorFB;
	_i_cmd_on_off_valve__faults_openedSensorFB = cmd_on_off_valve_openedSensorFB;
	_i_cmd_on_off_valve__faults_acknowledgePB = cmd_on_off_valve_acknowledgePB;
	_i_cmd_on_off_valve__faults_generalFault = cmd_on_off_valve_generalFault;
	_cmd_equipment_library__faults_init();

	cmd_equipment_library__cmd_on_off_valve_offset__end.Bool = self.Bool - __start.Bool;
	cmd_equipment_library__cmd_on_off_valve_offset__end.Int = self.Int - __start.Int;
	cmd_equipment_library__cmd_on_off_valve_offset__end.Float = self.Float - __start.Float;
	cmd_equipment_library__cmd_on_off_valve_offset__end.Char = self.Char - __start.Char;

	return 0;
}


/************************ Behavior function *************************/

int cmd_equipment_library__cmd_on_off_valve(void)
{
	CB_Object __start = self;
	int __ret;
	if (exec_mac_node(self_num)) {

		/*********************** Internals variables ************************/


		/********************* Pre-conditions execution *********************/

		/*no Pre-conditions*/

		/************************ Behavior execution ************************/

		{
			self.Bool = __start.Bool + cmd_equipment_library__cmd_on_off_valve_offset_actions.Bool;
			self.Int = __start.Int + cmd_equipment_library__cmd_on_off_valve_offset_actions.Int;
			self.Float = __start.Float + cmd_equipment_library__cmd_on_off_valve_offset_actions.Float;
			self.Char = __start.Char + cmd_equipment_library__cmd_on_off_valve_offset_actions.Char;

			/************************ actions execution *************************/

			self_num++;
			if (actuator__num != self_num) {
				actuator__num = self_num;
				_i_cmd_on_off_valve__actuator_autoMode = cmd_on_off_valve_autoMode;
				_i_cmd_on_off_valve__actuator_manualMode = cmd_on_off_valve_manualMode;
				_i_cmd_on_off_valve__actuator_autoCloseCmd = cmd_on_off_valve_autoCloseCmd;
				_i_cmd_on_off_valve__actuator_autoOpenCmd = cmd_on_off_valve_autoOpenCmd;
				_i_cmd_on_off_valve__actuator_closedSensorFB = cmd_on_off_valve_closedSensorFB;
				_i_cmd_on_off_valve__actuator_openedSensorFB = cmd_on_off_valve_openedSensorFB;
				_i_cmd_on_off_valve__actuator_closeValvePB = cmd_on_off_valve_closeValvePB;
				_i_cmd_on_off_valve__actuator_openValvePB = cmd_on_off_valve_openValvePB;
				_i_cmd_on_off_valve__actuator_generalFault = cmd_on_off_valve_generalFault;
				_i_cmd_on_off_valve__actuator_closeCmd = cmd_on_off_valve_closeCmd;
				_i_cmd_on_off_valve__actuator_openCmd = cmd_on_off_valve_openCmd;
			}
			__ret = cmd_equipment_library__actuator();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

			/************************ faults1 execution *************************/

			self_num++;
			if (faults__num != self_num) {
				faults__num = self_num;
				_i_cmd_on_off_valve__faults_closeCmd = cmd_on_off_valve_closeCmd;
				_i_cmd_on_off_valve__faults_openCmd = cmd_on_off_valve_openCmd;
				_i_cmd_on_off_valve__faults_closedSensorFB = cmd_on_off_valve_closedSensorFB;
				_i_cmd_on_off_valve__faults_openedSensorFB = cmd_on_off_valve_openedSensorFB;
				_i_cmd_on_off_valve__faults_acknowledgePB = cmd_on_off_valve_acknowledgePB;
				_i_cmd_on_off_valve__faults_generalFault = cmd_on_off_valve_generalFault;
			}
			__ret = cmd_equipment_library__faults();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

		}


		/******************** Post-conditions execution *********************/

		/*no Post-conditions*/
	}

	/*************************** self update ****************************/

	self.Bool = __start.Bool + cmd_equipment_library__cmd_on_off_valve_offset__end.Bool;
	self.Int = __start.Int + cmd_equipment_library__cmd_on_off_valve_offset__end.Int;
	self.Float = __start.Float + cmd_equipment_library__cmd_on_off_valve_offset__end.Float;
	self.Char = __start.Char + cmd_equipment_library__cmd_on_off_valve_offset__end.Char;

	return 0;
}

