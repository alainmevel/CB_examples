/*2024-04-12T14:05:57-01:00*/

/********************************************************************
 * management.c
 * 
 * generated by: plcgen 3.1.391
 ********************************************************************/

#include "cb_comp.h"
#include "iec_1131.h"

#include "management.h"


/**************************** Variables *****************************/

CB_Index management__num = 0;
CB_Mem_Bool *management_cycleInProgress;
CB_Mem_Bool *management_endCycleRequest;
CB_Mem_Bool *management_kneadingOk;
CB_Mem_Bool *management_syrupWeighingOk;
CB_Mem_Bool *management_flourWeighingOk;
CB_Mem_Bool *management_cycleEnd;
CB_Mem_Bool *management_flourWeighingRq;
CB_Mem_Bool *management_syrupWeighingRq;
CB_Mem_Bool *management_kneadingRq;
CB_Mem_Bool *management__X_10;
CB_Mem_Bool *management__X_11;
CB_Mem_Bool *management__X_12;
CB_Mem_Bool *management__X_13;
CB_Mem_Bool *management__X_14;
CB_Mem_Bool *management__X_11_PREV;
CB_Mem_Bool *management__X_12_PREV;
CB_Mem_Bool *management__X_14_PREV;

/**************************** Variables *****************************/

#define cycleInProgress (management_cycleInProgress->CB_current_value)
#define endCycleRequest (management_endCycleRequest->CB_current_value)
#define kneadingOk (management_kneadingOk->CB_current_value)
#define syrupWeighingOk (management_syrupWeighingOk->CB_current_value)
#define flourWeighingOk (management_flourWeighingOk->CB_current_value)
#define cycleEnd (management_cycleEnd->CB_current_value)
#define flourWeighingRq (management_flourWeighingRq->CB_current_value)
#define syrupWeighingRq (management_syrupWeighingRq->CB_current_value)
#define kneadingRq (management_kneadingRq->CB_current_value)
#define _X_10 (management__X_10->CB_current_value)
#define _X_11 (management__X_11->CB_current_value)
#define _X_12 (management__X_12->CB_current_value)
#define _X_13 (management__X_13->CB_current_value)
#define _X_14 (management__X_14->CB_current_value)
#define _X_11_PREV (management__X_11_PREV->CB_current_value)
#define _X_12_PREV (management__X_12_PREV->CB_current_value)
#define _X_14_PREV (management__X_14_PREV->CB_current_value)


/************************ Components offsets ************************/


/********************* Initialization function **********************/

int _copie_batch__management_init(void)
{
	(self.Bool+0)->CB_current_value = 1; /*_X_10*/
	self.Bool+=8;


	return 0;
}


/************************ Behavior function *************************/

int copie_batch__management(void)
{
	if (exec_term_node(self_num)) {

		/*********************** Internals variables ************************/

		management__X_10 = self.Bool+0;
		management__X_11 = self.Bool+1;
		management__X_12 = self.Bool+2;
		management__X_13 = self.Bool+3;
		management__X_14 = self.Bool+4;
		management__X_11_PREV = self.Bool+5;
		management__X_12_PREV = self.Bool+6;
		management__X_14_PREV = self.Bool+7;

		/********************* Pre-conditions execution *********************/

		/*no Pre-conditions*/

		/************************ Behavior execution ************************/

		{
			unsigned char _Y_10;
			unsigned char _Y_9;
			unsigned char _Y_8;
			unsigned char _Y_7;
			unsigned char _Y_6;
			/*pre-SFC*/
			/*transitions G1*/
			_Y_10 = _X_10 && cycleInProgress;
			_Y_9 = _X_11 && (flourWeighingOk && cycleInProgress);
			_Y_8 = _X_12 && (syrupWeighingOk && cycleInProgress);
			_Y_7 = _X_13 && (kneadingOk && cycleInProgress);
			_Y_6 = _X_14;
			/*evolutions G1*/
			if (_Y_10) {
				_X_10 = 0;
			}
			if (_Y_9) {
				_X_11 = 0;
			}
			if (_Y_8) {
				_X_12 = 0;
			}
			if (_Y_7) {
				_X_13 = 0;
			}
			if (_Y_6) {
				_X_14 = 0;
			}
			if (_Y_10) {
				_X_11 = 1;
			}
			if (_Y_9) {
				_X_12 = 1;
			}
			if (_Y_8) {
				_X_13 = 1;
			}
			if (_Y_7) {
				_X_14 = 1;
			}
			if (_Y_6) {
				_X_10 = 1;
			}
			/*timers G1*/
			/*actions G1*/
			if (CB_edge_bool(_X_11, _X_11_PREV) < 0) {
				flourWeighingRq = 0;
			}
			if (CB_edge_bool(_X_12, _X_12_PREV) < 0) {
				kneadingRq = 0;
				syrupWeighingRq = 0;
			}
			if (CB_edge_bool(_X_14, _X_14_PREV) < 0) {
				cycleEnd = 0;
			}
			if (_X_11) {
				flourWeighingRq = 1;
			}
			if (_X_12) {
				kneadingRq = 1;
				syrupWeighingRq = 1;
			}
			if (_X_14) {
				if (endCycleRequest) {
					cycleEnd = 1;
				}
				else {
					cycleEnd = 0;
				}
			}
			/*post-SFC*/
			_X_11_PREV = _X_11;
			_X_14_PREV = _X_14;
			_X_12_PREV = _X_12;
		}

		CB_post_bool(management_cycleEnd);
		CB_post_bool(management_flourWeighingRq);
		CB_post_bool(management_syrupWeighingRq);
		CB_post_bool(management_kneadingRq);

		/******************** Post-conditions execution *********************/

		/*no Post-conditions*/
	}

	/*************************** self update ****************************/

	self.Bool += 8;

	return 0;
}

