/*2023-10-03T11:13:42-01:00*/

/********************************************************************
 * mixing_cov.c
 * 
 * generated by: plcgen 3.1.391
 ********************************************************************/

#include "cb_comp.h"
#include "cb_covs.h"
#include "iec_1131.h"

#include "mixing.h"
#include "io_library/functional/io_agitator_2speed/io_agitator_2speed.h"
#include "equipment_library/functional/flow_compute/flow_compute.h"
#include "io_library/functional/io_single_acting_valve/io_single_acting_valve.h"
#include "equipment_library/functional/tank/tank.h"
#include "equipment_library/functional/bounded_scale/bounded_scale.h"
#include "equipment_library/functional/threshold_sensor/threshold_sensor.h"
#include "equipment_library/functional/analog_sensor/analog_sensor.h"


/**************************** Variables *****************************/

CB_Index mixing__num = 0;
CB_Mem_Bool *mixing_autoMode;
CB_Mem_Bool *mixing_manualMode;
CB_Mem_Bool *mixing_acknowledgePB;
CB_Mem_Bool *mixing_fillingValve;
CB_Mem_Bool *mixing_hiSpeedAgitator;
CB_Mem_Bool *mixing_loSpeedAgitator;
CB_Mem_Float *mixing_inputFlow;
CB_Mem_Bool *mixing_highLevel;
CB_Mem_Bool *mixing_lowLevel;
CB_Mem_Float *mixing_level;
CB_Mem_Float *mixing_outputFlow;

/**************************** Variables *****************************/



/************************ Components offsets ************************/

static CB_Offset bottling_line__mixing_offset_agitator;
static CB_Offset bottling_line__mixing_offset_flow;
static CB_Offset bottling_line__mixing_offset_valve5;
static CB_Offset bottling_line__mixing_offset_mixingTank;
static CB_Offset bottling_line__mixing_offset_levelScale;
static CB_Offset bottling_line__mixing_offset_highLevel3;
static CB_Offset bottling_line__mixing_offset_lowLevel3;
static CB_Offset bottling_line__mixing_offset_levelMeasurement;
static CB_Offset bottling_line__mixing_offset__end = {0, 0, 0, 0};


/********************* Initialization function **********************/

int _bottling_line__mixing_init(void)
{
	CB_Object __start = self;
	self.Bool+=7;
	self.Int+=2;
	self.Float+=8;

	/*initialize child agitator (io_library.io_agitator_2speed):*/
	self_num++;
	bottling_line__mixing_offset_agitator.Bool = self.Bool - __start.Bool;
	bottling_line__mixing_offset_agitator.Int = self.Int - __start.Int;
	bottling_line__mixing_offset_agitator.Float = self.Float - __start.Float;
	bottling_line__mixing_offset_agitator.Char = self.Char - __start.Char;
	io_agitator_2speed_acknowledgePB = mixing_acknowledgePB;
	io_agitator_2speed_autoMode = mixing_autoMode;
	io_agitator_2speed_manualMode = mixing_manualMode;
	io_agitator_2speed_autoHSCmd = mixing_hiSpeedAgitator;
	io_agitator_2speed_autoLSCmd = mixing_loSpeedAgitator;
	io_agitator_2speed_generalFault = __start.Bool+6; /*mixing__cn_4*/
	io_agitator_2speed_speedVal = __start.Float+4; /*mixing__cn_5*/
	io_agitator_2speed_speedPercent = __start.Float+3; /*mixing__cn_6*/
	_io_library__io_agitator_2speed_init();

	/*initialize child flow (equipment_library.flow_compute):*/
	self_num++;
	bottling_line__mixing_offset_flow.Bool = self.Bool - __start.Bool;
	bottling_line__mixing_offset_flow.Int = self.Int - __start.Int;
	bottling_line__mixing_offset_flow.Float = self.Float - __start.Float;
	bottling_line__mixing_offset_flow.Char = self.Char - __start.Char;
	flow_compute_inputFlow = __start.Float+5; /*mixing__cn_3*/
	flow_compute_outputFlow = __start.Float+6; /*mixing__cn_2*/
	_equipment_library__flow_compute_init();

	/*initialize child valve5 (io_library.io_single_acting_valve):*/
	self_num++;
	bottling_line__mixing_offset_valve5.Bool = self.Bool - __start.Bool;
	bottling_line__mixing_offset_valve5.Int = self.Int - __start.Int;
	bottling_line__mixing_offset_valve5.Float = self.Float - __start.Float;
	bottling_line__mixing_offset_valve5.Char = self.Char - __start.Char;
	io_single_acting_valve_acknowledgePB = mixing_acknowledgePB;
	io_single_acting_valve_autoMode = mixing_autoMode;
	io_single_acting_valve_manualMode = mixing_manualMode;
	io_single_acting_valve_autoOpenCmd = mixing_fillingValve;
	io_single_acting_valve_inputFlow = __start.Float+6; /*mixing__cn_2*/
	io_single_acting_valve_openedSensor = __start.Bool+5; /*mixing__cn_7*/
	io_single_acting_valve_closedSensor = __start.Bool+4; /*mixing__cn_8*/
	io_single_acting_valve_generalFault = __start.Bool+3; /*mixing__cn_9*/
	io_single_acting_valve_outputFlow = mixing_outputFlow;
	io_single_acting_valve_percentOpening = __start.Float+2; /*mixing__cn_10*/
	_io_library__io_single_acting_valve_init();

	/*initialize child mixingTank (equipment_library.tank):*/
	self_num++;
	bottling_line__mixing_offset_mixingTank.Bool = self.Bool - __start.Bool;
	bottling_line__mixing_offset_mixingTank.Int = self.Int - __start.Int;
	bottling_line__mixing_offset_mixingTank.Float = self.Float - __start.Float;
	bottling_line__mixing_offset_mixingTank.Char = self.Char - __start.Char;
	tank_inletFlow = mixing_inputFlow;
	tank_outletFlow = mixing_outputFlow;
	tank_tankLevel = __start.Float+5; /*mixing__cn_3*/
	_equipment_library__tank_init();

	/*initialize child levelScale (equipment_library.bounded_scale):*/
	self_num++;
	bottling_line__mixing_offset_levelScale.Bool = self.Bool - __start.Bool;
	bottling_line__mixing_offset_levelScale.Int = self.Int - __start.Int;
	bottling_line__mixing_offset_levelScale.Float = self.Float - __start.Float;
	bottling_line__mixing_offset_levelScale.Char = self.Char - __start.Char;
	bounded_scale_inputValue = __start.Float+5; /*mixing__cn_3*/
	bounded_scale_realValue = __start.Float+7; /*mixing__cn_1*/
	bounded_scale_dintValue = __start.Int+1; /*mixing__cn_11*/
	bounded_scale_intValue = __start.Int+0; /*mixing__cn_12*/
	_equipment_library__bounded_scale_init();

	/*initialize child highLevel3 (equipment_library.threshold_sensor):*/
	self_num++;
	bottling_line__mixing_offset_highLevel3.Bool = self.Bool - __start.Bool;
	bottling_line__mixing_offset_highLevel3.Int = self.Int - __start.Int;
	bottling_line__mixing_offset_highLevel3.Float = self.Float - __start.Float;
	bottling_line__mixing_offset_highLevel3.Char = self.Char - __start.Char;
	threshold_sensor_level = __start.Float+5; /*mixing__cn_3*/
	threshold_sensor_sensorSupply = __start.Bool+2; /*mixing__cn_13*/
	threshold_sensor_thresholdSensor = mixing_highLevel;
	_equipment_library__threshold_sensor_init();

	/*initialize child lowLevel3 (equipment_library.threshold_sensor):*/
	self_num++;
	bottling_line__mixing_offset_lowLevel3.Bool = self.Bool - __start.Bool;
	bottling_line__mixing_offset_lowLevel3.Int = self.Int - __start.Int;
	bottling_line__mixing_offset_lowLevel3.Float = self.Float - __start.Float;
	bottling_line__mixing_offset_lowLevel3.Char = self.Char - __start.Char;
	threshold_sensor_level = __start.Float+5; /*mixing__cn_3*/
	threshold_sensor_sensorSupply = __start.Bool+1; /*mixing__cn_14*/
	threshold_sensor_thresholdSensor = mixing_lowLevel;
	_equipment_library__threshold_sensor_init();

	/*initialize child levelMeasurement (equipment_library.analog_sensor):*/
	self_num++;
	bottling_line__mixing_offset_levelMeasurement.Bool = self.Bool - __start.Bool;
	bottling_line__mixing_offset_levelMeasurement.Int = self.Int - __start.Int;
	bottling_line__mixing_offset_levelMeasurement.Float = self.Float - __start.Float;
	bottling_line__mixing_offset_levelMeasurement.Char = self.Char - __start.Char;
	analog_sensor_measure = __start.Float+7; /*mixing__cn_1*/
	analog_sensor_sensorSupply = __start.Bool+0; /*mixing__cn_15*/
	analog_sensor_realValue = mixing_level;
	analog_sensor_intValue = __start.Float+1; /*mixing__cn_16*/
	analog_sensor_dintValue = __start.Float+0; /*mixing__cn_17*/
	_equipment_library__analog_sensor_init();

	bottling_line__mixing_offset__end.Bool = self.Bool - __start.Bool;
	bottling_line__mixing_offset__end.Int = self.Int - __start.Int;
	bottling_line__mixing_offset__end.Float = self.Float - __start.Float;
	bottling_line__mixing_offset__end.Char = self.Char - __start.Char;

	return 0;
}


/************************ Behavior function *************************/

int bottling_line__mixing(void)
{
	CB_Object __start = self;
	int __ret;
	static char *__comp_name = "bottling_line.mixing";
	if (exec_mac_node(self_num)) {

		/*********************** Internals variables ************************/

																																		
		/********************* Pre-conditions execution *********************/

		/*no Pre-conditions*/

		/************************ Behavior execution ************************/

		{
			self.Bool = __start.Bool + bottling_line__mixing_offset_agitator.Bool;
			self.Int = __start.Int + bottling_line__mixing_offset_agitator.Int;
			self.Float = __start.Float + bottling_line__mixing_offset_agitator.Float;
			self.Char = __start.Char + bottling_line__mixing_offset_agitator.Char;

			/************************ agitator execution ************************/

			self_num++;
			if (io_agitator_2speed__num != self_num) {
				io_agitator_2speed__num = self_num;
				io_agitator_2speed_acknowledgePB = mixing_acknowledgePB;
				io_agitator_2speed_autoMode = mixing_autoMode;
				io_agitator_2speed_manualMode = mixing_manualMode;
				io_agitator_2speed_autoHSCmd = mixing_hiSpeedAgitator;
				io_agitator_2speed_autoLSCmd = mixing_loSpeedAgitator;
				io_agitator_2speed_generalFault = __start.Bool+6; /*mixing__cn_4*/
				io_agitator_2speed_speedVal = __start.Float+4; /*mixing__cn_5*/
				io_agitator_2speed_speedPercent = __start.Float+3; /*mixing__cn_6*/
			}
			__ret = io_library__io_agitator_2speed();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

			/************************** flow execution **************************/

			self_num++;
			if (flow_compute__num != self_num) {
				flow_compute__num = self_num;
				flow_compute_inputFlow = __start.Float+5; /*mixing__cn_3*/
				flow_compute_outputFlow = __start.Float+6; /*mixing__cn_2*/
			}
			__ret = equipment_library__flow_compute();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

			/************************* valve5 execution *************************/

			self_num++;
			if (io_single_acting_valve__num != self_num) {
				io_single_acting_valve__num = self_num;
				io_single_acting_valve_acknowledgePB = mixing_acknowledgePB;
				io_single_acting_valve_autoMode = mixing_autoMode;
				io_single_acting_valve_manualMode = mixing_manualMode;
				io_single_acting_valve_autoOpenCmd = mixing_fillingValve;
				io_single_acting_valve_inputFlow = __start.Float+6; /*mixing__cn_2*/
				io_single_acting_valve_openedSensor = __start.Bool+5; /*mixing__cn_7*/
				io_single_acting_valve_closedSensor = __start.Bool+4; /*mixing__cn_8*/
				io_single_acting_valve_generalFault = __start.Bool+3; /*mixing__cn_9*/
				io_single_acting_valve_outputFlow = mixing_outputFlow;
				io_single_acting_valve_percentOpening = __start.Float+2; /*mixing__cn_10*/
			}
			__ret = io_library__io_single_acting_valve();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

			/*********************** mixingTank execution ***********************/

			self_num++;
			if (tank__num != self_num) {
				tank__num = self_num;
				tank_inletFlow = mixing_inputFlow;
				tank_outletFlow = mixing_outputFlow;
				tank_tankLevel = __start.Float+5; /*mixing__cn_3*/
			}
			__ret = equipment_library__tank();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

			/*********************** levelScale execution ***********************/

			self_num++;
			if (bounded_scale__num != self_num) {
				bounded_scale__num = self_num;
				bounded_scale_inputValue = __start.Float+5; /*mixing__cn_3*/
				bounded_scale_realValue = __start.Float+7; /*mixing__cn_1*/
				bounded_scale_dintValue = __start.Int+1; /*mixing__cn_11*/
				bounded_scale_intValue = __start.Int+0; /*mixing__cn_12*/
			}
			__ret = equipment_library__bounded_scale();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

			/*********************** highLevel3 execution ***********************/

			self_num++;
			if (threshold_sensor__num != self_num) {
				threshold_sensor__num = self_num;
				threshold_sensor_level = __start.Float+5; /*mixing__cn_3*/
				threshold_sensor_sensorSupply = __start.Bool+2; /*mixing__cn_13*/
				threshold_sensor_thresholdSensor = mixing_highLevel;
			}
			__ret = equipment_library__threshold_sensor();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

			/*********************** lowLevel3 execution ************************/

			self_num++;
			if (threshold_sensor__num != self_num) {
				threshold_sensor__num = self_num;
				threshold_sensor_level = __start.Float+5; /*mixing__cn_3*/
				threshold_sensor_sensorSupply = __start.Bool+1; /*mixing__cn_14*/
				threshold_sensor_thresholdSensor = mixing_lowLevel;
			}
			__ret = equipment_library__threshold_sensor();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

			/******************** levelMeasurement execution ********************/

			self_num++;
			if (analog_sensor__num != self_num) {
				analog_sensor__num = self_num;
				analog_sensor_measure = __start.Float+7; /*mixing__cn_1*/
				analog_sensor_sensorSupply = __start.Bool+0; /*mixing__cn_15*/
				analog_sensor_realValue = mixing_level;
				analog_sensor_intValue = __start.Float+1; /*mixing__cn_16*/
				analog_sensor_dintValue = __start.Float+0; /*mixing__cn_17*/
			}
			__ret = equipment_library__analog_sensor();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

		}


		/******************** Post-conditions execution *********************/

		/*no Post-conditions*/
	}

	/*************************** self update ****************************/

	self.Bool = __start.Bool + bottling_line__mixing_offset__end.Bool;
	self.Int = __start.Int + bottling_line__mixing_offset__end.Int;
	self.Float = __start.Float + bottling_line__mixing_offset__end.Float;
	self.Char = __start.Char + bottling_line__mixing_offset__end.Char;

	return 0;
}

