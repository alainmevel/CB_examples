/*2023-10-03T11:13:59-01:00*/

/********************************************************************
 * cp_trich.c
 * 
 * generated by: plcgen 3.1.391
 ********************************************************************/

#include "cb_comp.h"
#include "iec_1131.h"

#include "cp_trich.h"
#include "tri_chain/functional/input_chain_control/input_chain_control.h"
#include "tri_chain/functional/shuttle_control/shuttle_control.h"
#include "tri_chain/functional/shuttle_chain_control/shuttle_chain_control.h"
#include "tri_chain/functional/output_chain_control/output_chain_control.h"


/**************************** Variables *****************************/

CB_Index cp_trich__num = 0;
CB_Mem_Bool *cp_trich_ON;
CB_Mem_Bool *cp_trich_run1;
CB_Mem_Bool *cp_trich_startSensor1;
CB_Mem_Bool *cp_trich_endSensor1;
CB_Mem_Bool *cp_trich_run2;
CB_Mem_Bool *cp_trich_startSensor2;
CB_Mem_Bool *cp_trich_endSensor2;
CB_Mem_Bool *cp_trich_run3;
CB_Mem_Bool *cp_trich_startSensor3;
CB_Mem_Bool *cp_trich_endSensor3;
CB_Mem_Bool *cp_trich_sensor1;
CB_Mem_Bool *cp_trich_sensor2;
CB_Mem_Bool *cp_trich_sensor3;
CB_Mem_Bool *cp_trich_endSensor;
CB_Mem_Bool *cp_trich_endSensor4;
CB_Mem_Bool *cp_trich_mvt1;
CB_Mem_Bool *cp_trich_mvt2;
CB_Mem_Bool *cp_trich_mvt3;
CB_Mem_Bool *cp_trich_moveToLeft;
CB_Mem_Bool *cp_trich_moveToRight;
CB_Mem_Bool *cp_trich_chainMvt;
CB_Mem_Bool *cp_trich_mvt4;

/**************************** Variables *****************************/



/************************ Components offsets ************************/

static CB_Offset tri_chain__cp_trich_offset_chain1;
static CB_Offset tri_chain__cp_trich_offset_chain2;
static CB_Offset tri_chain__cp_trich_offset_chain3;
static CB_Offset tri_chain__cp_trich_offset_shuttleControl;
static CB_Offset tri_chain__cp_trich_offset_shuttleChain;
static CB_Offset tri_chain__cp_trich_offset_outputChain;
static CB_Offset tri_chain__cp_trich_offset__end = {0, 0, 0, 0};


/********************* Initialization function **********************/

int _tri_chain__cp_trich_init(void)
{
	CB_Object __start = self;
	self.Bool+=13;

	/*initialize child chain1 (tri_chain.input_chain_control):*/
	self_num++;
	tri_chain__cp_trich_offset_chain1.Bool = self.Bool - __start.Bool;
	tri_chain__cp_trich_offset_chain1.Int = self.Int - __start.Int;
	tri_chain__cp_trich_offset_chain1.Float = self.Float - __start.Float;
	tri_chain__cp_trich_offset_chain1.Char = self.Char - __start.Char;
	input_chain_control_globalRunning = cp_trich_ON;
	input_chain_control_localRunning = cp_trich_run1;
	input_chain_control_startSensor = cp_trich_startSensor1;
	input_chain_control_endSensor = cp_trich_endSensor1;
	input_chain_control_captureEnabled = __start.Bool+0; /*cp_trich__cn_13*/
	input_chain_control_movement = cp_trich_mvt1;
	input_chain_control_captureRequest = __start.Bool+3; /*cp_trich__cn_10*/
	input_chain_control_captureFinished = __start.Bool+4; /*cp_trich__cn_9*/
	_tri_chain__input_chain_control_init();

	/*initialize child chain2 (tri_chain.input_chain_control):*/
	self_num++;
	tri_chain__cp_trich_offset_chain2.Bool = self.Bool - __start.Bool;
	tri_chain__cp_trich_offset_chain2.Int = self.Int - __start.Int;
	tri_chain__cp_trich_offset_chain2.Float = self.Float - __start.Float;
	tri_chain__cp_trich_offset_chain2.Char = self.Char - __start.Char;
	input_chain_control_globalRunning = cp_trich_ON;
	input_chain_control_localRunning = cp_trich_run2;
	input_chain_control_startSensor = cp_trich_startSensor2;
	input_chain_control_endSensor = cp_trich_endSensor2;
	input_chain_control_captureEnabled = __start.Bool+1; /*cp_trich__cn_12*/
	input_chain_control_movement = cp_trich_mvt2;
	input_chain_control_captureRequest = __start.Bool+5; /*cp_trich__cn_8*/
	input_chain_control_captureFinished = __start.Bool+6; /*cp_trich__cn_7*/
	_tri_chain__input_chain_control_init();

	/*initialize child chain3 (tri_chain.input_chain_control):*/
	self_num++;
	tri_chain__cp_trich_offset_chain3.Bool = self.Bool - __start.Bool;
	tri_chain__cp_trich_offset_chain3.Int = self.Int - __start.Int;
	tri_chain__cp_trich_offset_chain3.Float = self.Float - __start.Float;
	tri_chain__cp_trich_offset_chain3.Char = self.Char - __start.Char;
	input_chain_control_globalRunning = cp_trich_ON;
	input_chain_control_localRunning = cp_trich_run3;
	input_chain_control_startSensor = cp_trich_startSensor3;
	input_chain_control_endSensor = cp_trich_endSensor3;
	input_chain_control_captureEnabled = __start.Bool+2; /*cp_trich__cn_11*/
	input_chain_control_movement = cp_trich_mvt3;
	input_chain_control_captureRequest = __start.Bool+7; /*cp_trich__cn_6*/
	input_chain_control_captureFinished = __start.Bool+8; /*cp_trich__cn_5*/
	_tri_chain__input_chain_control_init();

	/*initialize child shuttleControl (tri_chain.shuttle_control):*/
	self_num++;
	tri_chain__cp_trich_offset_shuttleControl.Bool = self.Bool - __start.Bool;
	tri_chain__cp_trich_offset_shuttleControl.Int = self.Int - __start.Int;
	tri_chain__cp_trich_offset_shuttleControl.Float = self.Float - __start.Float;
	tri_chain__cp_trich_offset_shuttleControl.Char = self.Char - __start.Char;
	shuttle_control_globalRunning = cp_trich_ON;
	shuttle_control_sensorPos1 = cp_trich_sensor1;
	shuttle_control_sensorPos2 = cp_trich_sensor2;
	shuttle_control_sensorPos3 = cp_trich_sensor3;
	shuttle_control_requestCapture1 = __start.Bool+3; /*cp_trich__cn_10*/
	shuttle_control_endCapture1 = __start.Bool+4; /*cp_trich__cn_9*/
	shuttle_control_requestCapture2 = __start.Bool+5; /*cp_trich__cn_8*/
	shuttle_control_endCapture2 = __start.Bool+6; /*cp_trich__cn_7*/
	shuttle_control_requestCapture3 = __start.Bool+7; /*cp_trich__cn_6*/
	shuttle_control_endCapture3 = __start.Bool+8; /*cp_trich__cn_5*/
	shuttle_control_depositRequest = __start.Bool+9; /*cp_trich__cn_4*/
	shuttle_control_depositFinished = __start.Bool+10; /*cp_trich__cn_3*/
	shuttle_control_enableCapture1 = __start.Bool+0; /*cp_trich__cn_13*/
	shuttle_control_enableCapture2 = __start.Bool+1; /*cp_trich__cn_12*/
	shuttle_control_enableCapture3 = __start.Bool+2; /*cp_trich__cn_11*/
	shuttle_control_enableCapture = __start.Bool+12; /*cp_trich__cn_1*/
	shuttle_control_enableDeposit = __start.Bool+11; /*cp_trich__cn_2*/
	shuttle_control_moveToLeft = cp_trich_moveToLeft;
	shuttle_control_moveToRight = cp_trich_moveToRight;
	_tri_chain__shuttle_control_init();

	/*initialize child shuttleChain (tri_chain.shuttle_chain_control):*/
	self_num++;
	tri_chain__cp_trich_offset_shuttleChain.Bool = self.Bool - __start.Bool;
	tri_chain__cp_trich_offset_shuttleChain.Int = self.Int - __start.Int;
	tri_chain__cp_trich_offset_shuttleChain.Float = self.Float - __start.Float;
	tri_chain__cp_trich_offset_shuttleChain.Char = self.Char - __start.Char;
	shuttle_chain_control_globalRunning = cp_trich_ON;
	shuttle_chain_control_endSensor = cp_trich_endSensor;
	shuttle_chain_control_depositEnabled = __start.Bool+11; /*cp_trich__cn_2*/
	shuttle_chain_control_captureEnabled = __start.Bool+12; /*cp_trich__cn_1*/
	shuttle_chain_control_movement = cp_trich_chainMvt;
	shuttle_chain_control_depositRequest = __start.Bool+9; /*cp_trich__cn_4*/
	shuttle_chain_control_depositFinished = __start.Bool+10; /*cp_trich__cn_3*/
	_tri_chain__shuttle_chain_control_init();

	/*initialize child outputChain (tri_chain.output_chain_control):*/
	self_num++;
	tri_chain__cp_trich_offset_outputChain.Bool = self.Bool - __start.Bool;
	tri_chain__cp_trich_offset_outputChain.Int = self.Int - __start.Int;
	tri_chain__cp_trich_offset_outputChain.Float = self.Float - __start.Float;
	tri_chain__cp_trich_offset_outputChain.Char = self.Char - __start.Char;
	output_chain_control_globalRunning = cp_trich_ON;
	output_chain_control_depositEnabled = __start.Bool+11; /*cp_trich__cn_2*/
	output_chain_control_endSensor = cp_trich_endSensor4;
	output_chain_control_movement = cp_trich_mvt4;
	_tri_chain__output_chain_control_init();

	tri_chain__cp_trich_offset__end.Bool = self.Bool - __start.Bool;
	tri_chain__cp_trich_offset__end.Int = self.Int - __start.Int;
	tri_chain__cp_trich_offset__end.Float = self.Float - __start.Float;
	tri_chain__cp_trich_offset__end.Char = self.Char - __start.Char;

	return 0;
}


/************************ Behavior function *************************/

int tri_chain__cp_trich(void)
{
	CB_Object __start = self;
	int __ret;
	if (exec_mac_node(self_num)) {

		/*********************** Internals variables ************************/

																										
		/********************* Pre-conditions execution *********************/

		/*no Pre-conditions*/

		/************************ Behavior execution ************************/

		{
			self.Bool = __start.Bool + tri_chain__cp_trich_offset_chain1.Bool;
			self.Int = __start.Int + tri_chain__cp_trich_offset_chain1.Int;
			self.Float = __start.Float + tri_chain__cp_trich_offset_chain1.Float;
			self.Char = __start.Char + tri_chain__cp_trich_offset_chain1.Char;

			/************************* chain1 execution *************************/

			self_num++;
			if (input_chain_control__num != self_num) {
				input_chain_control__num = self_num;
				input_chain_control_globalRunning = cp_trich_ON;
				input_chain_control_localRunning = cp_trich_run1;
				input_chain_control_startSensor = cp_trich_startSensor1;
				input_chain_control_endSensor = cp_trich_endSensor1;
				input_chain_control_captureEnabled = __start.Bool+0; /*cp_trich__cn_13*/
				input_chain_control_movement = cp_trich_mvt1;
				input_chain_control_captureRequest = __start.Bool+3; /*cp_trich__cn_10*/
				input_chain_control_captureFinished = __start.Bool+4; /*cp_trich__cn_9*/
			}
			__ret = tri_chain__input_chain_control();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

			/************************* chain2 execution *************************/

			self_num++;
			if (input_chain_control__num != self_num) {
				input_chain_control__num = self_num;
				input_chain_control_globalRunning = cp_trich_ON;
				input_chain_control_localRunning = cp_trich_run2;
				input_chain_control_startSensor = cp_trich_startSensor2;
				input_chain_control_endSensor = cp_trich_endSensor2;
				input_chain_control_captureEnabled = __start.Bool+1; /*cp_trich__cn_12*/
				input_chain_control_movement = cp_trich_mvt2;
				input_chain_control_captureRequest = __start.Bool+5; /*cp_trich__cn_8*/
				input_chain_control_captureFinished = __start.Bool+6; /*cp_trich__cn_7*/
			}
			__ret = tri_chain__input_chain_control();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

			/************************* chain3 execution *************************/

			self_num++;
			if (input_chain_control__num != self_num) {
				input_chain_control__num = self_num;
				input_chain_control_globalRunning = cp_trich_ON;
				input_chain_control_localRunning = cp_trich_run3;
				input_chain_control_startSensor = cp_trich_startSensor3;
				input_chain_control_endSensor = cp_trich_endSensor3;
				input_chain_control_captureEnabled = __start.Bool+2; /*cp_trich__cn_11*/
				input_chain_control_movement = cp_trich_mvt3;
				input_chain_control_captureRequest = __start.Bool+7; /*cp_trich__cn_6*/
				input_chain_control_captureFinished = __start.Bool+8; /*cp_trich__cn_5*/
			}
			__ret = tri_chain__input_chain_control();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

			/********************* shuttleControl execution *********************/

			self_num++;
			if (shuttle_control__num != self_num) {
				shuttle_control__num = self_num;
				shuttle_control_globalRunning = cp_trich_ON;
				shuttle_control_sensorPos1 = cp_trich_sensor1;
				shuttle_control_sensorPos2 = cp_trich_sensor2;
				shuttle_control_sensorPos3 = cp_trich_sensor3;
				shuttle_control_requestCapture1 = __start.Bool+3; /*cp_trich__cn_10*/
				shuttle_control_endCapture1 = __start.Bool+4; /*cp_trich__cn_9*/
				shuttle_control_requestCapture2 = __start.Bool+5; /*cp_trich__cn_8*/
				shuttle_control_endCapture2 = __start.Bool+6; /*cp_trich__cn_7*/
				shuttle_control_requestCapture3 = __start.Bool+7; /*cp_trich__cn_6*/
				shuttle_control_endCapture3 = __start.Bool+8; /*cp_trich__cn_5*/
				shuttle_control_depositRequest = __start.Bool+9; /*cp_trich__cn_4*/
				shuttle_control_depositFinished = __start.Bool+10; /*cp_trich__cn_3*/
				shuttle_control_enableCapture1 = __start.Bool+0; /*cp_trich__cn_13*/
				shuttle_control_enableCapture2 = __start.Bool+1; /*cp_trich__cn_12*/
				shuttle_control_enableCapture3 = __start.Bool+2; /*cp_trich__cn_11*/
				shuttle_control_enableCapture = __start.Bool+12; /*cp_trich__cn_1*/
				shuttle_control_enableDeposit = __start.Bool+11; /*cp_trich__cn_2*/
				shuttle_control_moveToLeft = cp_trich_moveToLeft;
				shuttle_control_moveToRight = cp_trich_moveToRight;
			}
			__ret = tri_chain__shuttle_control();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

			/********************** shuttleChain execution **********************/

			self_num++;
			if (shuttle_chain_control__num != self_num) {
				shuttle_chain_control__num = self_num;
				shuttle_chain_control_globalRunning = cp_trich_ON;
				shuttle_chain_control_endSensor = cp_trich_endSensor;
				shuttle_chain_control_depositEnabled = __start.Bool+11; /*cp_trich__cn_2*/
				shuttle_chain_control_captureEnabled = __start.Bool+12; /*cp_trich__cn_1*/
				shuttle_chain_control_movement = cp_trich_chainMvt;
				shuttle_chain_control_depositRequest = __start.Bool+9; /*cp_trich__cn_4*/
				shuttle_chain_control_depositFinished = __start.Bool+10; /*cp_trich__cn_3*/
			}
			__ret = tri_chain__shuttle_chain_control();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

			/********************** outputChain execution ***********************/

			self_num++;
			if (output_chain_control__num != self_num) {
				output_chain_control__num = self_num;
				output_chain_control_globalRunning = cp_trich_ON;
				output_chain_control_depositEnabled = __start.Bool+11; /*cp_trich__cn_2*/
				output_chain_control_endSensor = cp_trich_endSensor4;
				output_chain_control_movement = cp_trich_mvt4;
			}
			__ret = tri_chain__output_chain_control();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

		}


		/******************** Post-conditions execution *********************/

		/*no Post-conditions*/
	}

	/*************************** self update ****************************/

	self.Bool = __start.Bool + tri_chain__cp_trich_offset__end.Bool;
	self.Int = __start.Int + tri_chain__cp_trich_offset__end.Int;
	self.Float = __start.Float + tri_chain__cp_trich_offset__end.Float;
	self.Char = __start.Char + tri_chain__cp_trich_offset__end.Char;

	return 0;
}

