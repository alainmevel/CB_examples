/*2023-10-03T11:13:59-01:00*/

/********************************************************************
 * op_shuttle.c
 * 
 * generated by: plcgen 3.1.391
 ********************************************************************/

#include "cb_comp.h"
#include "iec_1131.h"

#include "op_shuttle.h"
#include "tri_chain/functional/motor2dir_1speed/motor2dir_1speed.h"
#include "tri_chain/functional/motor1dir_1speed/motor1dir_1speed.h"
#include "tri_chain/functional/axle_tri/axle_tri.h"
#include "tri_chain/functional/shuttle/shuttle.h"
#include "tri_chain/functional/rangesensor/rangesensor.h"
#include "tri_chain/functional/passing_sensor2/passing_sensor2.h"


/**************************** Variables *****************************/

CB_Index op_shuttle__num = 0;
CB_Mem_Bool *op_shuttle_forward;
CB_Mem_Bool *op_shuttle_backward;
CB_Mem_Bool *op_shuttle_chainMotorOn;
CB_Mem_Bool *op_shuttle_sensor_Pos1;
CB_Mem_Bool *op_shuttle_sensor_Pos2;
CB_Mem_Bool *op_shuttle_sensor_Pos3;
CB_Mem_Bool *op_shuttle_end_sensor;

/**************************** Variables *****************************/



/************************ Components offsets ************************/

static CB_Offset tri_chain__op_shuttle_offset_motor2dir;
static CB_Offset tri_chain__op_shuttle_offset_chainMotor;
static CB_Offset tri_chain__op_shuttle_offset_axle;
static CB_Offset tri_chain__op_shuttle_offset_shuttle;
static CB_Offset tri_chain__op_shuttle_offset_pos1Sensor;
static CB_Offset tri_chain__op_shuttle_offset_pos2Sensor;
static CB_Offset tri_chain__op_shuttle_offset_pos3Sensor;
static CB_Offset tri_chain__op_shuttle_offset_endSensor;
static CB_Offset tri_chain__op_shuttle_offset__end = {0, 0, 0, 0};


/********************* Initialization function **********************/

int _tri_chain__op_shuttle_init(void)
{
	CB_Object __start = self;
	self.Bool+=15;
	self.Float+=7;

	/*initialize child motor2dir (tri_chain.motor2dir_1speed):*/
	self_num++;
	tri_chain__op_shuttle_offset_motor2dir.Bool = self.Bool - __start.Bool;
	tri_chain__op_shuttle_offset_motor2dir.Int = self.Int - __start.Int;
	tri_chain__op_shuttle_offset_motor2dir.Float = self.Float - __start.Float;
	tri_chain__op_shuttle_offset_motor2dir.Char = self.Char - __start.Char;
	motor2dir_1speed_forward = op_shuttle_forward;
	motor2dir_1speed_backward = op_shuttle_backward;
	motor2dir_1speed_cmdSupply = __start.Bool+14; /*op_shuttle__cn_4*/
	motor2dir_1speed_sensorSupply = __start.Bool+13; /*op_shuttle__cn_5*/
	motor2dir_1speed_voltage380 = __start.Bool+12; /*op_shuttle__cn_6*/
	motor2dir_1speed_speedVal = __start.Float+4; /*op_shuttle__cn_3*/
	motor2dir_1speed_speedPercent = __start.Float+3; /*op_shuttle__cn_7*/
	motor2dir_1speed_thermal = __start.Bool+11; /*op_shuttle__cn_8*/
	motor2dir_1speed_backwardFB = __start.Bool+10; /*op_shuttle__cn_9*/
	motor2dir_1speed_forwardFB = __start.Bool+9; /*op_shuttle__cn_10*/
	_tri_chain__motor2dir_1speed_init();

	/*initialize child chainMotor (tri_chain.motor1dir_1speed):*/
	self_num++;
	tri_chain__op_shuttle_offset_chainMotor.Bool = self.Bool - __start.Bool;
	tri_chain__op_shuttle_offset_chainMotor.Int = self.Int - __start.Int;
	tri_chain__op_shuttle_offset_chainMotor.Float = self.Float - __start.Float;
	tri_chain__op_shuttle_offset_chainMotor.Char = self.Char - __start.Char;
	motor1dir_1speed_forward = op_shuttle_chainMotorOn;
	motor1dir_1speed_cmdSupply = __start.Bool+8; /*op_shuttle__cn_11*/
	motor1dir_1speed_sensorSupply = __start.Bool+7; /*op_shuttle__cn_12*/
	motor1dir_1speed_voltage380 = __start.Bool+6; /*op_shuttle__cn_13*/
	motor1dir_1speed_speedVal = __start.Float+5; /*op_shuttle__cn_2*/
	motor1dir_1speed_speedPercent = __start.Float+2; /*op_shuttle__cn_14*/
	motor1dir_1speed_thermal = __start.Bool+5; /*op_shuttle__cn_15*/
	motor1dir_1speed_forwardFB = __start.Bool+4; /*op_shuttle__cn_16*/
	_tri_chain__motor1dir_1speed_init();

	/*initialize child axle (tri_chain.axle_tri):*/
	self_num++;
	tri_chain__op_shuttle_offset_axle.Bool = self.Bool - __start.Bool;
	tri_chain__op_shuttle_offset_axle.Int = self.Int - __start.Int;
	tri_chain__op_shuttle_offset_axle.Float = self.Float - __start.Float;
	tri_chain__op_shuttle_offset_axle.Char = self.Char - __start.Char;
	axle_tri_speed = __start.Float+4; /*op_shuttle__cn_3*/
	axle_tri_positionTranslat = __start.Float+6; /*op_shuttle__cn_1*/
	axle_tri_percentTranslat = __start.Float+1; /*op_shuttle__cn_17*/
	axle_tri_incTranslat = __start.Float+0; /*op_shuttle__cn_18*/
	_tri_chain__axle_tri_init();

	/*initialize child shuttle (tri_chain.shuttle):*/
	self_num++;
	tri_chain__op_shuttle_offset_shuttle.Bool = self.Bool - __start.Bool;
	tri_chain__op_shuttle_offset_shuttle.Int = self.Int - __start.Int;
	tri_chain__op_shuttle_offset_shuttle.Float = self.Float - __start.Float;
	tri_chain__op_shuttle_offset_shuttle.Char = self.Char - __start.Char;
	shuttle_speedX = __start.Float+4; /*op_shuttle__cn_3*/
	shuttle_speedY = __start.Float+5; /*op_shuttle__cn_2*/
	_tri_chain__shuttle_init();

	/*initialize child pos1Sensor (tri_chain.rangesensor):*/
	self_num++;
	tri_chain__op_shuttle_offset_pos1Sensor.Bool = self.Bool - __start.Bool;
	tri_chain__op_shuttle_offset_pos1Sensor.Int = self.Int - __start.Int;
	tri_chain__op_shuttle_offset_pos1Sensor.Float = self.Float - __start.Float;
	tri_chain__op_shuttle_offset_pos1Sensor.Char = self.Char - __start.Char;
	rangesensor_level = __start.Float+6; /*op_shuttle__cn_1*/
	rangesensor_sensorSupply = __start.Bool+3; /*op_shuttle__cn_19*/
	rangesensor_rangeSensor = op_shuttle_sensor_Pos1;
	_tri_chain__rangesensor_init();

	/*initialize child pos2Sensor (tri_chain.rangesensor):*/
	self_num++;
	tri_chain__op_shuttle_offset_pos2Sensor.Bool = self.Bool - __start.Bool;
	tri_chain__op_shuttle_offset_pos2Sensor.Int = self.Int - __start.Int;
	tri_chain__op_shuttle_offset_pos2Sensor.Float = self.Float - __start.Float;
	tri_chain__op_shuttle_offset_pos2Sensor.Char = self.Char - __start.Char;
	rangesensor_level = __start.Float+6; /*op_shuttle__cn_1*/
	rangesensor_sensorSupply = __start.Bool+2; /*op_shuttle__cn_20*/
	rangesensor_rangeSensor = op_shuttle_sensor_Pos2;
	_tri_chain__rangesensor_init();

	/*initialize child pos3Sensor (tri_chain.rangesensor):*/
	self_num++;
	tri_chain__op_shuttle_offset_pos3Sensor.Bool = self.Bool - __start.Bool;
	tri_chain__op_shuttle_offset_pos3Sensor.Int = self.Int - __start.Int;
	tri_chain__op_shuttle_offset_pos3Sensor.Float = self.Float - __start.Float;
	tri_chain__op_shuttle_offset_pos3Sensor.Char = self.Char - __start.Char;
	rangesensor_level = __start.Float+6; /*op_shuttle__cn_1*/
	rangesensor_sensorSupply = __start.Bool+1; /*op_shuttle__cn_21*/
	rangesensor_rangeSensor = op_shuttle_sensor_Pos3;
	_tri_chain__rangesensor_init();

	/*initialize child endSensor (tri_chain.passing_sensor2):*/
	self_num++;
	tri_chain__op_shuttle_offset_endSensor.Bool = self.Bool - __start.Bool;
	tri_chain__op_shuttle_offset_endSensor.Int = self.Int - __start.Int;
	tri_chain__op_shuttle_offset_endSensor.Float = self.Float - __start.Float;
	tri_chain__op_shuttle_offset_endSensor.Char = self.Char - __start.Char;
	passing_sensor2_sensorSupply = __start.Bool+0; /*op_shuttle__cn_22*/
	passing_sensor2_deltaTranslation = __start.Float+6; /*op_shuttle__cn_1*/
	passing_sensor2_passing = op_shuttle_end_sensor;
	_tri_chain__passing_sensor2_init();

	tri_chain__op_shuttle_offset__end.Bool = self.Bool - __start.Bool;
	tri_chain__op_shuttle_offset__end.Int = self.Int - __start.Int;
	tri_chain__op_shuttle_offset__end.Float = self.Float - __start.Float;
	tri_chain__op_shuttle_offset__end.Char = self.Char - __start.Char;

	return 0;
}


/************************ Behavior function *************************/

int tri_chain__op_shuttle(void)
{
	CB_Object __start = self;
	int __ret;
	if (exec_mac_node(self_num)) {

		/*********************** Internals variables ************************/

																																												
		/********************* Pre-conditions execution *********************/

		/*no Pre-conditions*/

		/************************ Behavior execution ************************/

		{
			self.Bool = __start.Bool + tri_chain__op_shuttle_offset_motor2dir.Bool;
			self.Int = __start.Int + tri_chain__op_shuttle_offset_motor2dir.Int;
			self.Float = __start.Float + tri_chain__op_shuttle_offset_motor2dir.Float;
			self.Char = __start.Char + tri_chain__op_shuttle_offset_motor2dir.Char;

			/*********************** motor2dir execution ************************/

			self_num++;
			if (motor2dir_1speed__num != self_num) {
				motor2dir_1speed__num = self_num;
				motor2dir_1speed_forward = op_shuttle_forward;
				motor2dir_1speed_backward = op_shuttle_backward;
				motor2dir_1speed_cmdSupply = __start.Bool+14; /*op_shuttle__cn_4*/
				motor2dir_1speed_sensorSupply = __start.Bool+13; /*op_shuttle__cn_5*/
				motor2dir_1speed_voltage380 = __start.Bool+12; /*op_shuttle__cn_6*/
				motor2dir_1speed_speedVal = __start.Float+4; /*op_shuttle__cn_3*/
				motor2dir_1speed_speedPercent = __start.Float+3; /*op_shuttle__cn_7*/
				motor2dir_1speed_thermal = __start.Bool+11; /*op_shuttle__cn_8*/
				motor2dir_1speed_backwardFB = __start.Bool+10; /*op_shuttle__cn_9*/
				motor2dir_1speed_forwardFB = __start.Bool+9; /*op_shuttle__cn_10*/
			}
			__ret = tri_chain__motor2dir_1speed();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

			/*********************** chainMotor execution ***********************/

			self_num++;
			if (motor1dir_1speed__num != self_num) {
				motor1dir_1speed__num = self_num;
				motor1dir_1speed_forward = op_shuttle_chainMotorOn;
				motor1dir_1speed_cmdSupply = __start.Bool+8; /*op_shuttle__cn_11*/
				motor1dir_1speed_sensorSupply = __start.Bool+7; /*op_shuttle__cn_12*/
				motor1dir_1speed_voltage380 = __start.Bool+6; /*op_shuttle__cn_13*/
				motor1dir_1speed_speedVal = __start.Float+5; /*op_shuttle__cn_2*/
				motor1dir_1speed_speedPercent = __start.Float+2; /*op_shuttle__cn_14*/
				motor1dir_1speed_thermal = __start.Bool+5; /*op_shuttle__cn_15*/
				motor1dir_1speed_forwardFB = __start.Bool+4; /*op_shuttle__cn_16*/
			}
			__ret = tri_chain__motor1dir_1speed();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

			/************************** axle execution **************************/

			self_num++;
			if (axle_tri__num != self_num) {
				axle_tri__num = self_num;
				axle_tri_speed = __start.Float+4; /*op_shuttle__cn_3*/
				axle_tri_positionTranslat = __start.Float+6; /*op_shuttle__cn_1*/
				axle_tri_percentTranslat = __start.Float+1; /*op_shuttle__cn_17*/
				axle_tri_incTranslat = __start.Float+0; /*op_shuttle__cn_18*/
			}
			__ret = tri_chain__axle_tri();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

			/************************ shuttle execution *************************/

			self_num++;
			if (shuttle__num != self_num) {
				shuttle__num = self_num;
				shuttle_speedX = __start.Float+4; /*op_shuttle__cn_3*/
				shuttle_speedY = __start.Float+5; /*op_shuttle__cn_2*/
			}
			__ret = tri_chain__shuttle();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

			/*********************** pos1Sensor execution ***********************/

			self_num++;
			if (rangesensor__num != self_num) {
				rangesensor__num = self_num;
				rangesensor_level = __start.Float+6; /*op_shuttle__cn_1*/
				rangesensor_sensorSupply = __start.Bool+3; /*op_shuttle__cn_19*/
				rangesensor_rangeSensor = op_shuttle_sensor_Pos1;
			}
			__ret = tri_chain__rangesensor();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

			/*********************** pos2Sensor execution ***********************/

			self_num++;
			if (rangesensor__num != self_num) {
				rangesensor__num = self_num;
				rangesensor_level = __start.Float+6; /*op_shuttle__cn_1*/
				rangesensor_sensorSupply = __start.Bool+2; /*op_shuttle__cn_20*/
				rangesensor_rangeSensor = op_shuttle_sensor_Pos2;
			}
			__ret = tri_chain__rangesensor();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

			/*********************** pos3Sensor execution ***********************/

			self_num++;
			if (rangesensor__num != self_num) {
				rangesensor__num = self_num;
				rangesensor_level = __start.Float+6; /*op_shuttle__cn_1*/
				rangesensor_sensorSupply = __start.Bool+1; /*op_shuttle__cn_21*/
				rangesensor_rangeSensor = op_shuttle_sensor_Pos3;
			}
			__ret = tri_chain__rangesensor();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

			/*********************** endSensor execution ************************/

			self_num++;
			if (passing_sensor2__num != self_num) {
				passing_sensor2__num = self_num;
				passing_sensor2_sensorSupply = __start.Bool+0; /*op_shuttle__cn_22*/
				passing_sensor2_deltaTranslation = __start.Float+6; /*op_shuttle__cn_1*/
				passing_sensor2_passing = op_shuttle_end_sensor;
			}
			__ret = tri_chain__passing_sensor2();
			if (__ret != 0) {
				return __ret; /*child execution failure*/
			}

		}


		/******************** Post-conditions execution *********************/

		/*no Post-conditions*/
	}

	/*************************** self update ****************************/

	self.Bool = __start.Bool + tri_chain__op_shuttle_offset__end.Bool;
	self.Int = __start.Int + tri_chain__op_shuttle_offset__end.Int;
	self.Float = __start.Float + tri_chain__op_shuttle_offset__end.Float;
	self.Char = __start.Char + tri_chain__op_shuttle_offset__end.Char;

	return 0;
}

