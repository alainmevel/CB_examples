/*2023-10-03T11:13:56-01:00*/

/********************************************************************
 * shuttle.c
 * 
 * generated by: plcgen 3.1.391
 ********************************************************************/

#include "cb_comp.h"
#include "iec_1131.h"
#include "cb_products_iec.h"

#include "shuttle.h"



/**************************** Variables *****************************/

CB_Index shuttle__num = 0;
CB_Mem_Float *shuttle_speedX;
CB_Mem_Float *shuttle_speedY;
CB_Mem_Int *shuttle_status_act_prod;
CB_Mem_Float *shuttle_m11;
CB_Mem_Float *shuttle_m12;
CB_Mem_Float *shuttle_m13;
CB_Mem_Float *shuttle_m14;
CB_Mem_Float *shuttle_m21;
CB_Mem_Float *shuttle_m22;
CB_Mem_Float *shuttle_m23;
CB_Mem_Float *shuttle_m24;
CB_Mem_Float *shuttle_m31;
CB_Mem_Float *shuttle_m32;
CB_Mem_Float *shuttle_m33;
CB_Mem_Float *shuttle_m34;
CB_Mem_Float *shuttle_m41;
CB_Mem_Float *shuttle_m42;
CB_Mem_Float *shuttle_m43;
CB_Mem_Float *shuttle_m44;
CB_Mem_Float *shuttle_px;
CB_Mem_Float *shuttle_py;
CB_Mem_Float *shuttle_pz;
CB_Mem_Float *shuttle_dx;
CB_Mem_Float *shuttle_dy;
CB_Mem_Float *shuttle_dz;
CB_Mem_Float *shuttle_sProdX;
CB_Mem_Float *shuttle_sProdY;
CB_Mem_Bool *shuttle_d_locking;
CB_Mem_Bool *shuttle_v_d_locking;

/**************************** Variables *****************************/

#define speedX (shuttle_speedX->CB_current_value)
#define speedY (shuttle_speedY->CB_current_value)
#define status_act_prod (shuttle_status_act_prod->CB_current_value)
#define m11 (shuttle_m11->CB_current_value)
#define m12 (shuttle_m12->CB_current_value)
#define m13 (shuttle_m13->CB_current_value)
#define m14 (shuttle_m14->CB_current_value)
#define m21 (shuttle_m21->CB_current_value)
#define m22 (shuttle_m22->CB_current_value)
#define m23 (shuttle_m23->CB_current_value)
#define m24 (shuttle_m24->CB_current_value)
#define m31 (shuttle_m31->CB_current_value)
#define m32 (shuttle_m32->CB_current_value)
#define m33 (shuttle_m33->CB_current_value)
#define m34 (shuttle_m34->CB_current_value)
#define m41 (shuttle_m41->CB_current_value)
#define m42 (shuttle_m42->CB_current_value)
#define m43 (shuttle_m43->CB_current_value)
#define m44 (shuttle_m44->CB_current_value)
#define px (shuttle_px->CB_current_value)
#define py (shuttle_py->CB_current_value)
#define pz (shuttle_pz->CB_current_value)
#define dx (shuttle_dx->CB_current_value)
#define dy (shuttle_dy->CB_current_value)
#define dz (shuttle_dz->CB_current_value)
#define sProdX (shuttle_sProdX->CB_current_value)
#define sProdY (shuttle_sProdY->CB_current_value)
#define d_locking (shuttle_d_locking->CB_current_value)
#define v_d_locking (shuttle_v_d_locking->CB_current_value)


/************************ Components offsets ************************/


/********************* Initialization function **********************/

int _tri_chain__shuttle_init(void)
{
	(self.Float+0)->CB_current_value = 1.0; /*m11*/
	(self.Float+5)->CB_current_value = 1.0; /*m22*/
	(self.Float+10)->CB_current_value = 1.0; /*m33*/
	(self.Float+15)->CB_current_value = 1.0; /*m44*/
	self.Bool+=2;
	self.Int+=1;
	self.Float+=24;


	return 0;
}


/************************ Behavior function *************************/

int tri_chain__shuttle(void)
{
	if (exec_term_node(self_num)) {

		/*********************** Internals variables ************************/

		shuttle_status_act_prod = self.Int+0;
		shuttle_m11 = self.Float+0;
		shuttle_m12 = self.Float+1;
		shuttle_m13 = self.Float+2;
		shuttle_m14 = self.Float+3;
		shuttle_m21 = self.Float+4;
		shuttle_m22 = self.Float+5;
		shuttle_m23 = self.Float+6;
		shuttle_m24 = self.Float+7;
		shuttle_m31 = self.Float+8;
		shuttle_m32 = self.Float+9;
		shuttle_m33 = self.Float+10;
		shuttle_m34 = self.Float+11;
		shuttle_m41 = self.Float+12;
		shuttle_m42 = self.Float+13;
		shuttle_m43 = self.Float+14;
		shuttle_m44 = self.Float+15;
		shuttle_px = self.Float+16;
		shuttle_py = self.Float+17;
		shuttle_pz = self.Float+18;
		shuttle_dx = self.Float+19;
		shuttle_dy = self.Float+20;
		shuttle_dz = self.Float+21;
		shuttle_sProdX = self.Float+22;
		shuttle_sProdY = self.Float+23;
		shuttle_d_locking = self.Bool+0;
		shuttle_v_d_locking = self.Bool+1;

		/********************* Pre-conditions execution *********************/

		/*no Pre-conditions*/

		/************************ Actor Myself init *************************/

		setMyselfFor(self_num);

		/************************ Behavior execution ************************/

		{
			/* ----------------------------------------------------------------	*/
			/* Type : Model of Operative Behaviour					*/
			/* Category :  Conveyor							*/
			/* Author : Dassault Systemes						*/
			/* Update date : June 2018							*/
			/* ----------------------------------------------------------------	*/

			/* -----------------------------------------------------------------	*/
			/* px, py et pz are the lowest coordinates.				*/
			/* dx, dy et dz are the actor's dimensions 				*/
			/* sProdX is the speed given to the product for the X axis.		*/
			/* sProdY s the speed given to the product for the Y axis.		*/
			/* The linear speed is given in mm/s.					*/
			/* -----------------------------------------------------------------	*/

			/* -----------------------------------------------------------------	*/
			/* The cyclic pitch  in function of the simulation cycle time		*/
			/*		250 ms by default.						*/
			/*	CLOCK_PERIOD returns the cycle time in 1000th. of ms		*/
			/* -----------------------------------------------------------------	*/
			if (!d_locking)
				{
				sProdX=speedX*(CLOCK_PERIOD/1000000);
				sProdY=speedY*(CLOCK_PERIOD/1000000);
				}
			else 
				{
				sProdX=0;
				sProdY=0;
				}

			px = px + sProdX;

			moveTo(myself, px, py, pz);

		}


		/******************** Post-conditions execution *********************/

		/*no Post-conditions*/
	}

	/*************************** self update ****************************/

	self.Bool += 2;
	self.Int += 1;
	self.Float += 24;

	return 0;
}

